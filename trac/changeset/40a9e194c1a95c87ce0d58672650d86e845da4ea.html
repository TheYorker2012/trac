<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  

  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>
      Changeset 40a9e194c1a95c87ce0d58672650d86e845da4ea –
      The Yorker
    </title>
        <link rel="search" href="../search.html" />
        <link rel="prev" href="69105474b62164fb680aa662ca5424b80d5b7fd2.html" title="Changeset 69105474b62164fb680aa662ca5424b80d5b7fd2" />
        <link rel="last" href="4663e7077f9a41a86111194402f498613109bfa4.html" title="Changeset 4663e7077f9a41a86111194402f498613109bfa4" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="http://dev2.theyorker.co.uk/trac/changeset/40a9e194c1a95c87ce0d58672650d86e845da4ea?format=diff&new=40a9e194c1a95c87ce0d58672650d86e845da4ea" type="text/plain" class="diff" title="Unified Diff" /><link rel="alternate" href="http://dev2.theyorker.co.uk/trac/changeset/40a9e194c1a95c87ce0d58672650d86e845da4ea?format=zip&new=40a9e194c1a95c87ce0d58672650d86e845da4ea" type="application/zip" class="zip" title="Zip Archive" />
        <link rel="next" href="4717f4141d59bb14d445d084ee5a723938f227e8.html" title="Changeset 4717f4141d59bb14d445d084ee5a723938f227e8" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/changeset.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/diff.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/code.css" type="text/css" />
        <link rel="first" href="8f01cfef778eb063e661839b60a7226601ef07b1.html" title="Changeset 8f01cfef778eb063e661839b60a7226601ef07b1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search The Yorker" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/diff.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("li.entry h2 a").parent().addAnchor("Link to this diff");
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="../../trac.html"><img src="../../apps-logo.png" alt="The Yorker" /></a>
      </div>
      <form id="search" action="/trac/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first">logged in as nick_evans</li><li><a href="../../trac.html">Logout</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../browser.html">Browse Source</a></li><li><a href="../report.html">View Tickets</a></li><li><a href="../newticket.html">New Ticket</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
            <li class="first "><span>&larr; <a class="prev" href="69105474b62164fb680aa662ca5424b80d5b7fd2.html" title="Changeset 69105474b62164fb680aa662ca5424b80d5b7fd2">Previous Changeset</a></span></li><li class="last"><span><a class="next" href="4717f4141d59bb14d445d084ee5a723938f227e8.html" title="Changeset 4717f4141d59bb14d445d084ee5a723938f227e8">Next Changeset</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="changeset">
      <div id="title">
        <h1>Changeset 40a9e194c1a95c87ce0d58672650d86e845da4ea</h1>
      </div>
      <form id="prefs" action="">
        <div>
    <label for="style">View differences</label>
    <select id="style" name="style">
      <option selected="selected" value="inline">inline</option>
      <option value="sidebyside">side by side</option>
    </select>
    <div class="field">
      Show <input type="text" name="contextlines" id="contextlines" size="2" maxlength="3" value="2" />
      <label for="contextlines">lines around each change</label>
    </div>
    <fieldset id="ignore">
      <legend>Ignore:</legend>
      <div class="field">
        <input type="checkbox" id="ignoreblanklines" name="ignoreblanklines" />
        <label for="ignoreblanklines">Blank lines</label>
      </div>
      <div class="field">
        <input type="checkbox" id="ignorecase" name="ignorecase" />
        <label for="ignorecase">Case changes</label>
      </div>
      <div class="field">
        <input type="checkbox" id="ignorewhitespace" name="ignorewhitespace" />
        <label for="ignorewhitespace">White space changes</label>
      </div>
    </fieldset>
    <div class="buttons">
      <input type="submit" name="update" value="Update" />
    </div>
        </div>
      </form>
      <dl id="overview">
          <dt class="property time">Timestamp:</dt>
          <dd class="time">03/01/07 21:55:33 (<a class="timeline" href="http://dev2.theyorker.co.uk/trac/timeline?from=2007-03-01T21%3A55%3A33Z%2B0000&precision=second" title="2007-03-01T21:55:33Z+0000 in Timeline">9 years</a> ago)</dd>
          <dt class="property author">Author:</dt>
          <dd class="author">James Hogan &lt;james_hogan@…&gt;</dd>
              <dt class="property">Parents:</dt>
              <dd><a class="changeset" href="69105474b62164fb680aa662ca5424b80d5b7fd2.html" title="hopefully howdoi won't break when publishing">69105474b62164fb680aa662ca5424b80d5b7fd2</a></dd>
              <dt class="property">Children:</dt>
              <dd><a class="changeset" href="4717f4141d59bb14d445d084ee5a723938f227e8.html" title="Travis' ideas test page ;)">4717f4141d59bb14d445d084ee5a723938f227e8</a></dd>
              <dt class="property">git-committer:</dt>
              <dd>James Hogan &lt;james_hogan@theyorker.co.uk&gt; / 2007-03-01T21:55:33Z+0000</dd>
          <dt class="property message">Message:</dt>
          <dd class="message searchable">
            
            
              <p>
Permissions_helper<br />
</p>
<blockquote>
<p>
function <a class="missing wiki" href="../wiki/PermissionsSubset.html" rel="nofollow">PermissionsSubset?</a>($Subset, $Superset) returns whether the permissions of $Subset permission level are contained within $Superset permission level. This can be used to find whether the user has permission do do something without trying to obtain those permissions in the case that they do not. For example "if (<a class="missing wiki" href="../wiki/PermissionsSubset.html" rel="nofollow">PermissionsSubset?</a>('editor', <a class="missing wiki" href="http://dev2.theyorker.co.uk/trac/wiki/GetUserLevel" rel="nofollow">GetUserLevel?</a>())) Add editor link;". This checks if a user at <a class="missing wiki" href="http://dev2.theyorker.co.uk/trac/wiki/GetUserLevel" rel="nofollow">GetUserLevel?</a>() has the permissions an editor has.<br />
Owen, Let me know if this doesn't behave properly or anything. Its got a local static tree storing which permission levels are subsets of other permission levels and uses recursion to find $Subset from $Superset.<br />
</p>
</blockquote>

            
            
          </dd>
        <dt class="property files">Files:</dt>
        <dd class="files">
          <div class="legend" id="file-legend">
            <dl>
              <dt class="mod"></dt><dd>1 modified</dd>
            </dl>
          </div>
          <br />
          <ul>
            <li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=40a9e194c1a95c87ce0d58672650d86e845da4ea">
              system/application/helpers/permissions_helper.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="40a9e194c1a95c87ce0d58672650d86e845da4ea.html#file0">4 diffs</a>)
            </li>
          </ul>
        </dd>
      </dl>
      <div class="diff">
        <div class="legend" id="diff-legend">
          <h3>Legend:</h3>
          <dl>
            <dt class="unmod"></dt><dd>Unmodified</dd>
            <dt class="add"></dt><dd>Added</dd>
            <dt class="rem"></dt><dd>Removed</dd>
          </dl>
        </div>
        <div class="diff">
  <ul class="entries">
      <li class="entry">
        <h2 id="file0">
          <a title="Show the changeset 40a9e194c1a95c87ce0d58672650d86e845da4ea restricted to system/application/helpers/permissions_helper.php" href="http://dev2.theyorker.co.uk/trac/changeset/40a9e194c1a95c87ce0d58672650d86e845da4ea/system/application/helpers/permissions_helper.php">system/application/helpers/permissions_helper.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 923b23e6474ee542bb3007e0c538574752488c3c">
                    <a title="Show revision 923b23e6474ee542bb3007e0c538574752488c3c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=923b23e6474ee542bb3007e0c538574752488c3c#L33">
                      r923b2</a>
                  </th>
                  <th title="Revision 40a9e194c1a95c87ce0d58672650d86e845da4ea">
                    <a title="Show revision 40a9e194c1a95c87ce0d58672650d86e845da4ea of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=40a9e194c1a95c87ce0d58672650d86e845da4ea#L33">
                      r40a9e</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>33</th><th>33</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>34</th><th>34</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; return $user_level;</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>35</th><td class="r"><ins>}</ins> </td>
                  </tr><tr>
                          <th> </th><th>36</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>37</th><td class="r"><ins>/// Find whether the set of permissions for a level is a subset of another.</ins> </td>
                  </tr><tr>
                          <th> </th><th>38</th><td class="r"><ins>/**</ins> </td>
                  </tr><tr>
                          <th> </th><th>39</th><td class="r"><ins>&nbsp;* This is analagous to @a $Subset &lt;= @a $Superset.</ins> </td>
                  </tr><tr>
                          <th> </th><th>40</th><td class="r"><ins>&nbsp;* @param $Subset string Permission level to search for.</ins> </td>
                  </tr><tr>
                          <th> </th><th>41</th><td class="r"><ins>&nbsp;* @param $Superset string Permission level to search in.</ins> </td>
                  </tr><tr>
                          <th> </th><th>42</th><td class="r"><ins>&nbsp;* @return bool Whether all permissions of @a $Subset are permissions of</ins> </td>
                  </tr><tr>
                          <th> </th><th>43</th><td class="r"><ins>&nbsp;*&nbsp; &nbsp; &nbsp; @a $Superset.</ins> </td>
                  </tr><tr>
                          <th> </th><th>44</th><td class="r"><ins>&nbsp;*/</ins> </td>
                  </tr><tr>
                          <th> </th><th>45</th><td class="r"><ins>function PermissionsSubset($Subset, $Superset)</ins> </td>
                  </tr><tr>
                          <th> </th><th>46</th><td class="r"><ins>{</ins> </td>
                  </tr><tr>
                          <th> </th><th>47</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; // Tree of which subsets of each permission level.</ins> </td>
                  </tr><tr>
                          <th> </th><th>48</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; static $permission_subsets = array(</ins> </td>
                  </tr><tr>
                          <th> </th><th>49</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'public'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; array(),</ins> </td>
                  </tr><tr>
                          <th> </th><th>50</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'student'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; array('public'&nbsp; &nbsp; &nbsp; &nbsp;=&gt; TRUE),</ins> </td>
                  </tr><tr>
                          <th> </th><th>51</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'organisation'&nbsp; =&gt; array('student'&nbsp; &nbsp; &nbsp; =&gt; TRUE),</ins> </td>
                  </tr><tr>
                          <th> </th><th>52</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'vip'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; array('student'&nbsp; &nbsp; &nbsp; =&gt; TRUE),</ins> </td>
                  </tr><tr>
                          <th> </th><th>53</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'office'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; array('student'&nbsp; &nbsp; &nbsp; =&gt; TRUE),</ins> </td>
                  </tr><tr>
                          <th> </th><th>54</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'pr'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; array('office'&nbsp; &nbsp; &nbsp; &nbsp;=&gt; TRUE),</ins> </td>
                  </tr><tr>
                          <th> </th><th>55</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'editor'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; array('pr'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; TRUE),</ins> </td>
                  </tr><tr>
                          <th> </th><th>56</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'admin'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; array('editor'&nbsp; &nbsp; &nbsp; &nbsp;=&gt; TRUE),</ins> </td>
                  </tr><tr>
                          <th> </th><th>57</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; );</ins> </td>
                  </tr><tr>
                          <th> </th><th>58</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>59</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; // Unknown superset, assume its empty, always fail.</ins> </td>
                  </tr><tr>
                          <th> </th><th>60</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; if (!array_key_exists($Superset, $permission_subsets)) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>61</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return FALSE;</ins> </td>
                  </tr><tr>
                          <th> </th><th>62</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>63</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; // If the superset IS the subset allow.</ins> </td>
                  </tr><tr>
                          <th> </th><th>64</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; if ($Superset === $Subset) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>65</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return TRUE;</ins> </td>
                  </tr><tr>
                          <th> </th><th>66</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>67</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; // If the subset is an explicit subset identifier of superset use it directly.</ins> </td>
                  </tr><tr>
                          <th> </th><th>68</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; if (array_key_exists($Subset, $permission_subsets[$Superset])) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>69</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $permission_subsets[$Superset][$Subset];</ins> </td>
                  </tr><tr>
                          <th> </th><th>70</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>71</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; // Go through the supersets subsets in a depth first manner to find subset.</ins> </td>
                  </tr><tr>
                          <th> </th><th>72</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; foreach ($permission_subsets[$Superset] as $superset_subset) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>73</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $subset_found = ResolvePermission($Subset, $superset_subset);</ins> </td>
                  </tr><tr>
                          <th> </th><th>74</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($subset_found) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>75</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // $Subset is a subset of $Superset</ins> </td>
                  </tr><tr>
                          <th> </th><th>76</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return TRUE;</ins> </td>
                  </tr><tr>
                          <th> </th><th>77</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>78</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Negative: try any other parent permissions before giving up.</ins> </td>
                  </tr><tr>
                          <th> </th><th>79</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>80</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; // All explicit subsets checked. Must not be a subset.</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>81</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; return FALSE;</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>35</th><th>82</th><td class="l"><span>}</span> </td>
                  </tr><tr>
                          <th>36</th><th>83</th><td class="l"><span></span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=923b23e6474ee542bb3007e0c538574752488c3c#L137">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=40a9e194c1a95c87ce0d58672650d86e845da4ea#L184">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>137</th><th>184</th><td class="l"><span>function CheckPermissions($Permission = 'public', $LoadMainFrame = TRUE, $NoPost = FALSE)</span> </td>
                  </tr><tr>
                          <th>138</th><th>185</th><td class="l"><span>{</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="last first">
                          <th> </th><th>186</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; // Initialisation stuff</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>139</th><th>187</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; $CI = &amp;get_instance();</span> </td>
                  </tr><tr>
                          <th>140</th><th>188</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; $CI-&gt;load-&gt;library('messages');</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=923b23e6474ee542bb3007e0c538574752488c3c#L143">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=40a9e194c1a95c87ce0d58672650d86e845da4ea#L191">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>143</th><th>191</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; $user_level = GetUserLevel(); // loads the user_auth library</span> </td>
                  </tr><tr>
                          <th>144</th><th>192</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>145</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; // <del>Check whether the page is accessed in a special way</del></span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>193</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; // <ins>URL analysis regarding vip area</ins></span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>146</th><th>194</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; $thru_viparea&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&nbsp; &nbsp; &nbsp; &nbsp;(&nbsp; &nbsp; &nbsp; &nbsp;($CI-&gt;uri-&gt;total_segments() &gt;= 1)</span> </td>
                  </tr><tr>
                          <th>147</th><th>195</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp;&nbsp; &nbsp; &nbsp; ($CI-&gt;uri-&gt;segment(1) === 'viparea'));</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=923b23e6474ee542bb3007e0c538574752488c3c#L149">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/helpers/permissions_helper.php?rev=40a9e194c1a95c87ce0d58672650d86e845da4ea#L197">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>149</th><th>197</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp;&nbsp; &nbsp; &nbsp; ($CI-&gt;uri-&gt;segment(1) === 'office')</span> </td>
                  </tr><tr>
                          <th>150</th><th>198</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;&amp;&nbsp; &nbsp; &nbsp; ($CI-&gt;uri-&gt;segment(2) === 'vip'));</span> </td>
                  </tr>
            </tbody><tbody class="rem">
                  <tr class="last first">
                          <th>151</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; </del> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>152</th><th>199</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; $organisation_specified = FALSE;</span> </td>
                  </tr><tr>
                          <th>153</th><th>200</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; if ($thru_viparea) {</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
  </ul>
</div>
      </div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="http://dev2.theyorker.co.uk/trac/changeset/40a9e194c1a95c87ce0d58672650d86e845da4ea?format=diff&new=40a9e194c1a95c87ce0d58672650d86e845da4ea" class="diff">Unified Diff</a>
        </li><li class="last">
          <a rel="nofollow" href="http://dev2.theyorker.co.uk/trac/changeset/40a9e194c1a95c87ce0d58672650d86e845da4ea?format=zip&new=40a9e194c1a95c87ce0d58672650d86e845da4ea" class="zip">Zip Archive</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">
        Powered by <a href="../about.html"><strong>Trac 0.11.1</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.
      </p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>