<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  

  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>
      Changeset b898331d5e5550775358c4e1853c0bae324e302c –
      The Yorker
    </title>
        <link rel="search" href="../search.html" />
        <link rel="prev" href="c3f7c83eedfef6186f995298ea6493eb67c46c8d.html" title="Changeset c3f7c83eedfef6186f995298ea6493eb67c46c8d" />
        <link rel="last" href="4663e7077f9a41a86111194402f498613109bfa4.html" title="Changeset 4663e7077f9a41a86111194402f498613109bfa4" />
        <link rel="help" href="../wiki/TracGuide.html" />
        <link rel="alternate" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c?format=diff&new=b898331d5e5550775358c4e1853c0bae324e302c" type="text/plain" class="diff" title="Unified Diff" /><link rel="alternate" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c?format=zip&new=b898331d5e5550775358c4e1853c0bae324e302c" type="application/zip" class="zip" title="Zip Archive" />
        <link rel="next" href="97d33cd4ea148bbef091f7c0dec8ed9d79c35e6f.html" title="Changeset 97d33cd4ea148bbef091f7c0dec8ed9d79c35e6f" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/changeset.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/diff.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/code.css" type="text/css" />
        <link rel="first" href="8f01cfef778eb063e661839b60a7226601ef07b1.html" title="Changeset 8f01cfef778eb063e661839b60a7226601ef07b1" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search The Yorker" />
    <script type="text/javascript" src="../chrome/common/js/jquery.js"></script><script type="text/javascript" src="../chrome/common/js/trac.js"></script><script type="text/javascript" src="../chrome/common/js/search.js"></script><script type="text/javascript" src="../chrome/common/js/diff.js"></script>
    <!--[if lt IE 7]>
    <script type="text/javascript" src="/trac/chrome/common/js/ie_pre7_hacks.js"></script>
    <![endif]-->
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("li.entry h2 a").parent().addAnchor("Link to this diff");
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="../../trac.html"><img src="../../apps-logo.png" alt="The Yorker" /></a>
      </div>
      <form id="search" action="/trac/search" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first">logged in as nick_evans</li><li><a href="../../trac.html">Logout</a></li><li><a href="../prefs.html">Preferences</a></li><li><a href="../wiki/TracGuide.html">Help/Guide</a></li><li class="last"><a href="../about.html">About Trac</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li class="active"><a href="../browser.html">Browse Source</a></li><li><a href="../report.html">View Tickets</a></li><li><a href="../newticket.html">New Ticket</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
          <ul>
            <li class="first "><span>&larr; <a class="prev" href="c3f7c83eedfef6186f995298ea6493eb67c46c8d.html" title="Changeset c3f7c83eedfef6186f995298ea6493eb67c46c8d">Previous Changeset</a></span></li><li class="last"><span><a class="next" href="97d33cd4ea148bbef091f7c0dec8ed9d79c35e6f.html" title="Changeset 97d33cd4ea148bbef091f7c0dec8ed9d79c35e6f">Next Changeset</a> &rarr;</span></li>
          </ul>
        <hr />
      </div>
    <div id="content" class="changeset">
      <div id="title">
        <h1>Changeset b898331d5e5550775358c4e1853c0bae324e302c</h1>
      </div>
      <form id="prefs" action="">
        <div>
    <label for="style">View differences</label>
    <select id="style" name="style">
      <option selected="selected" value="inline">inline</option>
      <option value="sidebyside">side by side</option>
    </select>
    <div class="field">
      Show <input type="text" name="contextlines" id="contextlines" size="2" maxlength="3" value="2" />
      <label for="contextlines">lines around each change</label>
    </div>
    <fieldset id="ignore">
      <legend>Ignore:</legend>
      <div class="field">
        <input type="checkbox" id="ignoreblanklines" name="ignoreblanklines" />
        <label for="ignoreblanklines">Blank lines</label>
      </div>
      <div class="field">
        <input type="checkbox" id="ignorecase" name="ignorecase" />
        <label for="ignorecase">Case changes</label>
      </div>
      <div class="field">
        <input type="checkbox" id="ignorewhitespace" name="ignorewhitespace" />
        <label for="ignorewhitespace">White space changes</label>
      </div>
    </fieldset>
    <div class="buttons">
      <input type="submit" name="update" value="Update" />
    </div>
        </div>
      </form>
      <dl id="overview">
          <dt class="property time">Timestamp:</dt>
          <dd class="time">04/06/07 23:28:18 (<a class="timeline" href="http://dev2.theyorker.co.uk/trac/timeline?from=2007-04-06T23%3A28%3A18Z%2B0000&precision=second" title="2007-04-06T23:28:18Z+0000 in Timeline">8 years</a> ago)</dd>
          <dt class="property author">Author:</dt>
          <dd class="author">James Hogan &lt;james_hogan@…&gt;</dd>
              <dt class="property">Parents:</dt>
              <dd><a class="changeset" href="c3f7c83eedfef6186f995298ea6493eb67c46c8d.html" title="bar crawl mockups">c3f7c83eedfef6186f995298ea6493eb67c46c8d</a></dd>
              <dt class="property">Children:</dt>
              <dd><a class="changeset" href="97d33cd4ea148bbef091f7c0dec8ed9d79c35e6f.html" title="controllers/test/james thread adder now includes review_context threads">97d33cd4ea148bbef091f7c0dec8ed9d79c35e6f</a></dd>
              <dt class="property">git-committer:</dt>
              <dd>James Hogan &lt;james_hogan@theyorker.co.uk&gt; / 2007-04-06T23:28:18Z+0000</dd>
          <dt class="property message">Message:</dt>
          <dd class="message searchable">
            
            
              <p>
Mostly updates relating to comments <a class="missing ticket" href="../ticket/186.html" rel="nofollow">#186</a> <a class="missing ticket" href="../ticket/187.html" rel="nofollow">#187</a> <a class="missing ticket" href="../ticket/189.html" rel="nofollow">#189</a><br />
Also tidy + fixes to wikiparser <a class="missing ticket" href="http://dev2.theyorker.co.uk/trac/ticket/190" rel="nofollow">#190</a><br />
</p>
<p>
controllers<br />
</p>
<blockquote>
<p>
admin<br />
</p>
<blockquote>
<p>
tools        some misc admin tools included wikitext cache flushing, wikitext tester, trigger generation etc.<br />
</p>
</blockquote>
<p>
office<br />
</p>
<blockquote>
<p>
news        uses comments system, though needs doing properly<br />
</p>
</blockquote>
<p>
test<br />
</p>
<blockquote>
<p>
james        testing functions for comments and calendar<br />
</p>
</blockquote>
<p>
comments        simple controller for reporting abusive comments<br />
news                uses comments system<br />
</p>
<blockquote>
<blockquote>
<p>
rss uses mime type application/rss+xml<br />
</p>
</blockquote>
</blockquote>
<p>
reviews                uses comments system<br />
</p>
</blockquote>
<p>
libraries<br />
</p>
<blockquote>
<p>
comments        helper library for showing comments in standard format<br />
frames                FramesView::<a class="missing wiki" href="http://dev2.theyorker.co.uk/trac/wiki/GetData" rel="nofollow">GetData?</a> has extra parameter, returned if data doesn't exist<br />
wikiparser        disable preformatting with leading whitespace<br />
</p>
<blockquote>
<p>
<a class="missing ticket" href="http://dev2.theyorker.co.uk/trac/ticket/190" rel="nofollow">#190</a> explicit variable declaration, undocumented<br />
<a class="missing ticket" href="http://dev2.theyorker.co.uk/trac/ticket/190" rel="nofollow">#190</a> should now be stateless and produce same output on consecutive calls with identical input.<br />
style class for "the yorker" etc set to theyorker<br />
</p>
</blockquote>
</blockquote>
<p>
models<br />
</p>
<blockquote>
<p>
article_model        removed old comment getting functions<br />
comments_model        used for all the comments stuff<br />
news_model                functions utilising comments_model for getting article threads<br />
</p>
<blockquote>
<p>
<a class="missing wiki" href="http://dev2.theyorker.co.uk/trac/wiki/GetFullArticle" rel="nofollow">GetFullArticle?</a> includes public thread id in output<br />
</p>
</blockquote>
<p>
review_model        uses new comments system<br />
</p>
</blockquote>
<p>
views<br />
</p>
<blockquote>
<p>
admin<br />
</p>
<blockquote>
<p>
tools<br />
</p>
<blockquote>
<p>
wikitext        wikitext tester view copied from views/test<br />
</p>
</blockquote>
</blockquote>
<p>
comments<br />
</p>
<blockquote>
<p>
add                        comment adding view<br />
comment                individual comment view<br />
thread                thread information and rating<br />
standard        standard combination of add, comment list, thread information<br />
</p>
</blockquote>
<p>
news<br />
</p>
<blockquote>
<p>
news                load comments view<br />
</p>
</blockquote>
<p>
office<br />
</p>
<blockquote>
<p>
news<br />
</p>
<blockquote>
<p>
article        load comments view, commented out old comments stuff, this needs updating<br />
</p>
</blockquote>
</blockquote>
<p>
reviews<br />
</p>
<blockquote>
<p>
mainreview        load comments view, replacing old comments stuff<br />
</p>
</blockquote>
<p>
templates<br />
</p>
<blockquote>
<p>
list                template view for displaying lists of other views, with multiple pages for many<br />
</p>
</blockquote>
</blockquote>
<p>
system/libraries/Router                Fixed bug where uris with the same set of segments but different combination were considered equal. This caused function argments to be offset.<br />
</p>

            
            
          </dd>
          <dt class="property location">Location:</dt>
          <dd class="searchable"><a href="http://dev2.theyorker.co.uk/trac/browser/system?rev=b898331d5e5550775358c4e1853c0bae324e302c">system</a></dd>
        <dt class="property files">Files:</dt>
        <dd class="files">
          <div class="legend" id="file-legend">
            <dl>
              <dt class="add"></dt><dd>10 added</dd>
              <dt class="mod"></dt><dd>13 modified</dd>
            </dl>
          </div>
          <br />
          <ul>
            <li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/admin/tools.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/controllers/admin/tools.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/comments.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/controllers/comments.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/news.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/controllers/news.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file2">3 diffs</a>)
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/office/news.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/controllers/office/news.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file3">1 diff</a>)
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/controllers/reviews.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file4">4 diffs</a>)
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/test/james.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/controllers/test/james.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file5">1 diff</a>)
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Comments.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/libraries/Comments.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Frames.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/libraries/Frames.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file7">1 diff</a>)
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/libraries/Wikiparser.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file8">6 diffs</a>)
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/article_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/models/article_model.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file9">1 diff</a>)
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/comments_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/models/comments_model.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/news_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/models/news_model.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file11">3 diffs</a>)
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/models/review_model.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file12">9 diffs</a>)
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/admin/tools/wikitext.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/admin/tools/wikitext.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/comments/add.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/comments/add.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/comments/comment.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/comments/comment.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/comments/standard.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/comments/standard.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/comments/thread.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/comments/thread.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/news/news.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/news/news.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file18">1 diff</a>)
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/office/news/article.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/office/news/article.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file19">2 diffs</a>)
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/reviews/mainreview.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/reviews/mainreview.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file20">1 diff</a>)
            </li><li>
          <div class="add"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/templates/list.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              application/views/templates/list.php
            </a>
          <span class="comment">(added)</span>
            </li><li>
          <div class="mod"> </div>
            <a title="Show entry in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/libraries/Router.php?rev=b898331d5e5550775358c4e1853c0bae324e302c">
              libraries/Router.php
            </a>
          <span class="comment">(modified)</span>
              (<a title="Show differences" href="b898331d5e5550775358c4e1853c0bae324e302c.html#file22">1 diff</a>)
            </li>
          </ul>
        </dd>
      </dl>
      <div class="diff">
        <div class="legend" id="diff-legend">
          <h3>Legend:</h3>
          <dl>
            <dt class="unmod"></dt><dd>Unmodified</dd>
            <dt class="add"></dt><dd>Added</dd>
            <dt class="rem"></dt><dd>Removed</dd>
          </dl>
        </div>
        <div class="diff">
  <ul class="entries">
      <li class="entry">
        <h2 id="file2">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/controllers/news.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/controllers/news.php">system/application/controllers/news.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 3ce4eb20801f5467b266e553b573f287dc9bc51d">
                    <a title="Show revision 3ce4eb20801f5467b266e553b573f287dc9bc51d of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/news.php?rev=3ce4eb20801f5467b266e553b573f287dc9bc51d#L28">
                      r3ce4e</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/news.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L28">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>28</th><th>28</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>29</th><th>29</th><td class="l"><span></span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>30</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; function index($article_type = 'uninews'<del></del>)</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>30</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; function index($article_type = 'uninews'<ins>, $CommentInclude = 0</ins>)</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>31</th><th>31</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; {</span> </td>
                  </tr><tr>
                          <th>32</th><th>32</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Load public view</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/news.php?rev=3ce4eb20801f5467b266e553b573f287dc9bc51d#L120">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/news.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L120">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>120</th><th>120</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array_push($news_others, $this-&gt;News_model-&gt;GetSimpleArticle($latest_article_ids[$index], "Left"));</span> </td>
                  </tr><tr>
                          <th>121</th><th>121</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>122</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>123</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Get comments</ins> </td>
                  </tr><tr>
                          <th> </th><th>124</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (is_numeric($main_article['public_thread_id'])) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>125</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('comments');</ins> </td>
                  </tr><tr>
                          <th> </th><th>126</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $CommentInclude = $this-&gt;uri-&gt;segment(4);</ins> </td>
                  </tr><tr>
                          <th> </th><th>127</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (FALSE === $CommentInclude) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>128</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $CommentInclude = NULL;</ins> </td>
                  </tr><tr>
                          <th> </th><th>129</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>130</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;comments-&gt;SetUri('/news/'.$article_type.'/'.$latest_article_ids[0].'/');</ins> </td>
                  </tr><tr>
                          <th> </th><th>131</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['comments'] = $this-&gt;comments-&gt;CreateStandard((int)$main_article['public_thread_id'], $CommentInclude);</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>132</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>122</th><th>133</th><td class="l"><span></span> </td>
                  </tr><tr>
                          <th>123</th><th>134</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// Gather all the data into an array to be passed to the view</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/news.php?rev=3ce4eb20801f5467b266e553b573f287dc9bc51d#L149">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/news.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L160">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>149</th><th>160</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; function rss()</span> </td>
                  </tr><tr>
                          <th>150</th><th>161</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; {</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="last first">
                          <th> </th><th>162</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; header('Content-type: application/rss+xml');</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>151</th><th>163</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['rss_title'] = 'York Uni Campus News';</span> </td>
                  </tr><tr>
                          <th>152</th><th>164</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['rss_link'] = 'http://www.theyorker.co.uk/news/';</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file3">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/controllers/office/news.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/controllers/office/news.php">system/application/controllers/office/news.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision a8acf20edd15d72e3c8dfcc38009b39fd33babbe">
                    <a title="Show revision a8acf20edd15d72e3c8dfcc38009b39fd33babbe of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/office/news.php?rev=a8acf20edd15d72e3c8dfcc38009b39fd33babbe#L667">
                      ra8acf</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/office/news.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L667">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>667</th><th>667</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['request_heading'] = $this-&gt;pages_model-&gt;GetPropertyText('request_heading');</span> </td>
                  </tr><tr>
                          <th>668</th><th>668</th><td class="l"><span></span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>669</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['comments'] = $this-&gt;article_model-&gt;GetArticleComments($article_id);</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>669</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// @todo jh559,cdt502 ajaxify comments</span> </td>
                      </tr><tr>
                        <th> </th><th>670</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('comments');</span> </td>
                      </tr><tr>
                        <th> </th><th>671</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $thread = $this-&gt;news_model-&gt;GetPrivateThread($article_id);</span> </td>
                      </tr><tr>
                        <th> </th><th>672</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;comments-&gt;SetUri('/office/news/'.$article_id.'/');</span> </td>
                      </tr><tr>
                        <th> </th><th>673</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /// @todo jh559,cdt502 comment pages (page hardwired to 1 atm)</span> </td>
                      </tr><tr>
                        <th> </th><th>674</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['comments'] = $this-&gt;comments-&gt;CreateStandard($thread, /* included comment */ 0);</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>675</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>670</th><th>676</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['revisions'] = $this-&gt;requests_model-&gt;GetArticleRevisions($article_id);</span> </td>
                  </tr><tr>
                          <th>671</th><th>677</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $revision = $this-&gt;article_model-&gt;GetLatestRevision($article_id);</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file4">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/controllers/reviews.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/controllers/reviews.php">system/application/controllers/reviews.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 9686f519d5a2b3b3ab905bc261e38f578e010a96">
                    <a title="Show revision 9686f519d5a2b3b3ab905bc261e38f578e010a96 of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=9686f519d5a2b3b3ab905bc261e38f578e010a96#L183">
                      r9686f</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L183">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>183</th><th>183</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                  </tr><tr>
                          <th>184</th><th>184</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; /// Review page</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>185</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; function _review($content_type, $organisation_name<del></del>)</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>185</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; function _review($content_type, $organisation_name<ins>, $IncludedComment = 0</ins>)</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>186</th><th>186</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; {</span> </td>
                  </tr><tr>
                          <th>187</th><th>187</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!CheckPermissions('public')) return;</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=9686f519d5a2b3b3ab905bc261e38f578e010a96#L205">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L205">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>205</th><th>205</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['organisation_id'] = $this-&gt;Review_model-&gt;FindOrganisationID($organisation_name);</span> </td>
                  </tr><tr>
                          <th>206</th><th>206</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['type_id']&nbsp; &nbsp; &nbsp; &nbsp; = $content_id;</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>207</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['comments']&nbsp; &nbsp; &nbsp; &nbsp;= $this-&gt;Review_model-&gt;GetComments($organisation_name,$content_id,$article_comment_id);</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>207</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                      </tr><tr>
                        <th> </th><th>208</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('comments');</span> </td>
                      </tr><tr>
                        <th> </th><th>209</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;comments-&gt;SetUri('/reviews/'.$content_type.'/'.$organisation_name.'/');</span> </td>
                      </tr><tr>
                        <th> </th><th>210</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $thread = $this-&gt;Review_model-&gt;GetReviewContextCommentThread($data['organisation_id'], $content_id);</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>211</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['comments'] = $this-&gt;comments-&gt;CreateStandard($thread, $IncludedComment);</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>208</th><th>212</th><td class="l"><span></span> </td>
                  </tr><tr>
                          <th>209</th><th>213</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //For barcrawls only - The right side barlist</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=9686f519d5a2b3b3ab905bc261e38f578e010a96#L250">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L254">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>250</th><th>254</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Place articles into the data array to be passed along</span> </td>
                  </tr><tr>
                          <th>251</th><th>255</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['article'] = $article;</span> </td>
                  </tr>
            </tbody><tbody class="rem">
                  <tr class="first">
                          <th>252</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>253</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Get user rating</del> </td>
                  </tr><tr>
                          <th>254</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['user_rating'] = $this-&gt;Review_model-&gt;GetUserRating($article_id);</del> </td>
                  </tr><tr>
                          <th>255</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['user_rating'] = $data['user_rating'][0];</del> </td>
                  </tr><tr>
                          <th>256</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['user_based'] = $this-&gt;Review_model-&gt;GetUserRating($article_id);</del> </td>
                  </tr><tr class="last">
                          <th>257</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data['user_based'] = $data['user_based'][1];</del> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>258</th><th>256</th><td class="l"><span></span> </td>
                  </tr><tr>
                          <th>259</th><th>257</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Review context content</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=9686f519d5a2b3b3ab905bc261e38f578e010a96#L393">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/reviews.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L391">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>393</th><th>391</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $entries[$reviewno]['review_website'] = $database_result[$reviewno]['organisation_content_url'];</span> </td>
                  </tr><tr>
                          <th>394</th><th>392</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $entries[$reviewno]['review_rating'] = $database_result[$reviewno]['review_context_content_rating'];</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>395</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $entries[$reviewno]['review_user_rating'] = intval($database_result[$reviewno]['<del>comment_summary_cache_average</del>_rating']);</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>393</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $entries[$reviewno]['review_user_rating'] = intval($database_result[$reviewno]['<ins>average_user</ins>_rating']);</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>396</th><th>394</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $entries[$reviewno]['review_table_link'] = base_url().'reviews/'.$item_type.'/'.$database_result[$reviewno]['organisation_directory_entry_name']; </span> </td>
                  </tr><tr>
                          <th>397</th><th>395</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file5">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/controllers/test/james.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/controllers/test/james.php">system/application/controllers/test/james.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 0bad22cdbd2134dbd634bb17da1c5d4a0512a26e">
                    <a title="Show revision 0bad22cdbd2134dbd634bb17da1c5d4a0512a26e of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/test/james.php?rev=0bad22cdbd2134dbd634bb17da1c5d4a0512a26e#L39">
                      r0bad2</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/controllers/test/james.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L39">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>39</th><th>39</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;main_frame-&gt;Load();</span> </td>
                  </tr><tr>
                          <th>40</th><th>40</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>41</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>42</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; function test()</ins> </td>
                  </tr><tr>
                          <th> </th><th>43</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; {</ins> </td>
                  </tr><tr>
                          <th> </th><th>44</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!CheckPermissions('admin')) return;</ins> </td>
                  </tr><tr>
                          <th> </th><th>45</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>46</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Load libraries</ins> </td>
                  </tr><tr>
                          <th> </th><th>47</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('academic_calendar');</ins> </td>
                  </tr><tr>
                          <th> </th><th>48</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('calendar_backend');</ins> </td>
                  </tr><tr>
                          <th> </th><th>49</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('calendar_frontend');</ins> </td>
                  </tr><tr>
                          <th> </th><th>50</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>51</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('calendar_source_yorker');</ins> </td>
                  </tr><tr>
                          <th> </th><th>52</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('calendar_view_days');</ins> </td>
                  </tr><tr>
                          <th> </th><th>53</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>54</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Set up data sources</ins> </td>
                  </tr><tr>
                          <th> </th><th>55</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data = new CalendarData();</ins> </td>
                  </tr><tr>
                          <th> </th><th>56</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sources = array();</ins> </td>
                  </tr><tr>
                          <th> </th><th>57</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sources[0] = new CalendarSourceYorker();</ins> </td>
                  </tr><tr>
                          <th> </th><th>58</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sources[0]-&gt;SetRange(strtotime('-2month'), strtotime('1month'));</ins> </td>
                  </tr><tr>
                          <th> </th><th>59</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>60</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Accumulate data from sources in $data</ins> </td>
                  </tr><tr>
                          <th> </th><th>61</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach ($sources as $source) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>62</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {</ins> </td>
                  </tr><tr>
                          <th> </th><th>63</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $source-&gt;FetchEvents($data);</ins> </td>
                  </tr><tr>
                          <th> </th><th>64</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (Exception $e) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>65</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;messages-&gt;AddMessage('error', 'calendar data source failed: '.$e-&gt;getMessage());</ins> </td>
                  </tr><tr>
                          <th> </th><th>66</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>67</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>68</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>69</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Display data</ins> </td>
                  </tr><tr>
                          <th> </th><th>70</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>71</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $days = new CalendarViewDays();</ins> </td>
                  </tr><tr>
                          <th> </th><th>72</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $days-&gt;SetCalendarData($data);</ins> </td>
                  </tr><tr>
                          <th> </th><th>73</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>74</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;main_frame-&gt;SetContent($days);</ins> </td>
                  </tr><tr>
                          <th> </th><th>75</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>76</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Load view</ins> </td>
                  </tr><tr>
                          <th> </th><th>77</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;main_frame-&gt;Load();</ins> </td>
                  </tr><tr>
                          <th> </th><th>78</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>79</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>80</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; function wikify()</ins> </td>
                  </tr><tr>
                          <th> </th><th>81</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; {</ins> </td>
                  </tr><tr>
                          <th> </th><th>82</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $wikitext = $this-&gt;input-&gt;post('CommentAddContent');</ins> </td>
                  </tr><tr>
                          <th> </th><th>83</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($wikitext !== FALSE) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>84</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;model('comments_model');</ins> </td>
                  </tr><tr>
                          <th> </th><th>85</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $xhtml = $this-&gt;comments_model-&gt;ParseCommentWikitext($wikitext);</ins> </td>
                  </tr><tr>
                          <th> </th><th>86</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;view('test/echo', array('content' =&gt; $xhtml));</ins> </td>
                  </tr><tr>
                          <th> </th><th>87</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>88</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>89</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>90</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; function trig($CommentInclude = 1)</ins> </td>
                  </tr><tr>
                          <th> </th><th>91</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; {</ins> </td>
                  </tr><tr>
                          <th> </th><th>92</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!CheckPermissions('public')) return;</ins> </td>
                  </tr><tr>
                          <th> </th><th>93</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>94</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Get thread</ins> </td>
                  </tr><tr>
                          <th> </th><th>95</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $thread_id = 1;</ins> </td>
                  </tr><tr>
                          <th> </th><th>96</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>97</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;library('comments');</ins> </td>
                  </tr><tr>
                          <th> </th><th>98</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>99</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;comments-&gt;SetUri('/test/james/trig/');</ins> </td>
                  </tr><tr>
                          <th> </th><th>100</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;main_frame-&gt;SetContent(</ins> </td>
                  </tr><tr>
                          <th> </th><th>101</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;comments-&gt;CreateStandard($thread_id, $CommentInclude)</ins> </td>
                  </tr><tr>
                          <th> </th><th>102</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );</ins> </td>
                  </tr><tr>
                          <th> </th><th>103</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>104</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Load view</ins> </td>
                  </tr><tr>
                          <th> </th><th>105</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;main_frame-&gt;Load();</ins> </td>
                  </tr><tr>
                          <th> </th><th>106</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>107</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>108</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; function addcomments($place)</ins> </td>
                  </tr><tr>
                          <th> </th><th>109</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; {</ins> </td>
                  </tr><tr>
                          <th> </th><th>110</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!CheckPermissions('admin')) return;</ins> </td>
                  </tr><tr>
                          <th> </th><th>111</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;load-&gt;model('comments_model');</ins> </td>
                  </tr><tr>
                          <th> </th><th>112</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($place == 'articles') {</ins> </td>
                  </tr><tr>
                          <th> </th><th>113</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result = $this-&gt;comments_model-&gt;CreateThreads(</ins> </td>
                  </tr><tr>
                          <th> </th><th>114</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</ins> </td>
                  </tr><tr>
                          <th> </th><th>115</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'allow_ratings' =&gt; FALSE,</ins> </td>
                  </tr><tr>
                          <th> </th><th>116</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'allow_comments' =&gt; TRUE,</ins> </td>
                  </tr><tr>
                          <th> </th><th>117</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'allow_anonymous_comments' =&gt; TRUE,</ins> </td>
                  </tr><tr>
                          <th> </th><th>118</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ),</ins> </td>
                  </tr><tr>
                          <th> </th><th>119</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'articles',</ins> </td>
                  </tr><tr>
                          <th> </th><th>120</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'article_id',</ins> </td>
                  </tr><tr>
                          <th> </th><th>121</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'article_public_comment_thread_id'</ins> </td>
                  </tr><tr>
                          <th> </th><th>122</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );</ins> </td>
                  </tr><tr>
                          <th> </th><th>123</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;messages-&gt;AddDumpMessage('public result', $result);</ins> </td>
                  </tr><tr>
                          <th> </th><th>124</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;comments_model-&gt;CreateThreads(</ins> </td>
                  </tr><tr>
                          <th> </th><th>125</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</ins> </td>
                  </tr><tr>
                          <th> </th><th>126</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'allow_ratings' =&gt; TRUE,</ins> </td>
                  </tr><tr>
                          <th> </th><th>127</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'allow_comments' =&gt; TRUE,</ins> </td>
                  </tr><tr>
                          <th> </th><th>128</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'allow_anonymous_comments' =&gt; FALSE,</ins> </td>
                  </tr><tr>
                          <th> </th><th>129</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ),</ins> </td>
                  </tr><tr>
                          <th> </th><th>130</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'articles',</ins> </td>
                  </tr><tr>
                          <th> </th><th>131</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'article_id',</ins> </td>
                  </tr><tr>
                          <th> </th><th>132</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'article_private_comment_thread_id'</ins> </td>
                  </tr><tr>
                          <th> </th><th>133</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );</ins> </td>
                  </tr><tr>
                          <th> </th><th>134</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;messages-&gt;AddDumpMessage('private result', $result);</ins> </td>
                  </tr><tr>
                          <th> </th><th>135</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>136</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;main_frame-&gt;Load();</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>137</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>41</th><th>138</th><td class="l"><span>}</span> </td>
                  </tr><tr>
                          <th>42</th><th>139</th><td class="l"><span></span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file7">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/libraries/Frames.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/libraries/Frames.php">system/application/libraries/Frames.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 676857395e4d44ab98ab6cf2d1ba489cec2f950a">
                    <a title="Show revision 676857395e4d44ab98ab6cf2d1ba489cec2f950a of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Frames.php?rev=676857395e4d44ab98ab6cf2d1ba489cec2f950a#L78">
                      r67685</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Frames.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L78">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>78</th><th>78</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @return The data associated with @a $Index in the data array.</span> </td>
                  </tr><tr>
                          <th>79</th><th>79</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>80</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; function GetData($Index)</span> </td>
                      </tr><tr>
                        <th>81</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; {</span> </td>
                      </tr><tr>
                        <th>82</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $this-&gt;mDataArray[$Index];</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>80</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; function GetData($Index, $Default = NULL)</span> </td>
                      </tr><tr>
                        <th> </th><th>81</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; {</span> </td>
                      </tr><tr>
                        <th> </th><th>82</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return (array_key_exists($Index, $this-&gt;mDataArray)</span> </td>
                      </tr><tr>
                        <th> </th><th>83</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? $this-&gt;mDataArray[$Index]</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>84</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $Default);</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>83</th><th>85</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>84</th><th>86</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file8">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/libraries/Wikiparser.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/libraries/Wikiparser.php">system/application/libraries/Wikiparser.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 60778438bb6d222fed293b44a127a22642c5b55a">
                    <a title="Show revision 60778438bb6d222fed293b44a127a22642c5b55a of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=60778438bb6d222fed293b44a127a22642c5b55a#L42">
                      r60778</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L42">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>42</th><th>42</th><td class="l"><span>/// Wikitext parsing library.</span> </td>
                  </tr><tr>
                          <th>43</th><th>43</th><td class="l"><span>class Wikiparser {</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>44</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $reference_wiki;</ins> </td>
                  </tr><tr>
                          <th> </th><th>45</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $external_wikis;</ins> </td>
                  </tr><tr>
                          <th> </th><th>46</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $image_uri;</ins> </td>
                  </tr><tr>
                          <th> </th><th>47</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $image_overrides;</ins> </td>
                  </tr><tr>
                          <th> </th><th>48</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $ignore_images;</ins> </td>
                  </tr><tr>
                          <th> </th><th>49</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $emphasis;</ins> </td>
                  </tr><tr>
                          <th> </th><th>50</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $quote_template;</ins> </td>
                  </tr><tr>
                          <th> </th><th>51</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $templates;</ins> </td>
                  </tr><tr>
                          <th> </th><th>52</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>53</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $list_level_chars;</ins> </td>
                  </tr><tr>
                          <th> </th><th>54</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $list_level;</ins> </td>
                  </tr><tr>
                          <th> </th><th>55</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $deflist;</ins> </td>
                  </tr><tr>
                          <th> </th><th>56</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $linknumber;</ins> </td>
                  </tr><tr>
                          <th> </th><th>57</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $suppress_linebreaks;</ins> </td>
                  </tr><tr>
                          <th> </th><th>58</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $in_paragraph;</ins> </td>
                  </tr><tr>
                          <th> </th><th>59</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $page_title;</ins> </td>
                  </tr><tr>
                          <th> </th><th>60</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $stop;</ins> </td>
                  </tr><tr>
                          <th> </th><th>61</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $stop_all;</ins> </td>
                  </tr><tr>
                          <th> </th><th>62</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $nextnowiki;</ins> </td>
                  </tr><tr>
                          <th> </th><th>63</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $redirect;</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>64</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; protected $nowikis;</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>44</th><th>65</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                  </tr><tr>
                          <th>45</th><th>66</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; /// Default constructor.</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=60778438bb6d222fed293b44a127a22642c5b55a#L52">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L73">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>52</th><th>73</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;image_uri = '/images/';</span> </td>
                  </tr><tr>
                          <th>53</th><th>74</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;image_overrides = array();</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>54</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;ignore_images = <del>false</del>;</span> </td>
                      </tr><tr>
                        <th>55</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[1] = <del>''</del>;</span> </td>
                      </tr><tr>
                        <th>56</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[2] = <del>''</del>;</span> </td>
                      </tr><tr>
                        <th>57</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[3] = <del>''</del>;</span> </td>
                      </tr><tr>
                        <th>58</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[4] = <del>''</del>;</span> </td>
                      </tr><tr>
                        <th>59</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[5] = <del>''</del>;</span> </td>
                      </tr><tr>
                        <th>60</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[6] = <del>''</del>;</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>75</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;ignore_images = <ins>FALSE</ins>;</span> </td>
                      </tr><tr>
                        <th> </th><th>76</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[1] = <ins>FALSE</ins>;</span> </td>
                      </tr><tr>
                        <th> </th><th>77</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[2] = <ins>FALSE</ins>;</span> </td>
                      </tr><tr>
                        <th> </th><th>78</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[3] = <ins>FALSE</ins>;</span> </td>
                      </tr><tr>
                        <th> </th><th>79</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[4] = <ins>FALSE</ins>;</span> </td>
                      </tr><tr>
                        <th> </th><th>80</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[5] = <ins>FALSE</ins>;</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>81</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[6] = <ins>FALSE</ins>;</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>61</th><th>82</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                  </tr><tr>
                          <th>62</th><th>83</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;quote_template = 'pull_quote';</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=60778438bb6d222fed293b44a127a22642c5b55a#L67">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L88">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>67</th><th>88</th><td class="l"><span>&lt;img src="/images/prototype/news/quote_close.png" alt="Quote" title="Quote" /&gt;</span> </td>
                  </tr><tr>
                          <th>68</th><th>89</th><td class="l"><span>&lt;br /&gt;&lt;span class="author"&gt;{{2}}&lt;/span&gt;&lt;/blockquote&gt;',</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="last first">
                          <th> </th><th>90</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'frame' =&gt; '&lt;div class="BlueBox"&gt;&lt;h4&gt;{{1}}&lt;/h4&gt;{{2}}&lt;/div&gt;',</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>69</th><th>91</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'br' =&gt; '&lt;br /&gt;',</span> </td>
                  </tr><tr>
                          <th>70</th><th>92</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=60778438bb6d222fed293b44a127a22642c5b55a#L394">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L416">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>394</th><th>416</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span> </td>
                  </tr><tr>
                          <th>395</th><th>417</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; function handle_addemphasis($matches) {</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>396</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $output = '&lt;<del>em&gt;&lt;strong&gt;&lt;span class="orange</del>"&gt;'; // Orange emphasis</span> </td>
                      </tr><tr>
                        <th>397</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $output .= $matches[0];&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</del>// Actual text</span> </td>
                      </tr><tr>
                        <th>398</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $output .= '&lt;/span&gt;<del>&lt;/strong&gt;&lt;/em&gt;';</del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Orange emphasis</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>418</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $output = '&lt;<ins>span class="theyorker</ins>"&gt;'; // Orange emphasis</span> </td>
                      </tr><tr>
                        <th> </th><th>419</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $output .= $matches[0];&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<ins></ins>// Actual text</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>420</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $output .= '&lt;/span&gt;<ins>';&nbsp; &nbsp; &nbsp;</ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Orange emphasis</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>399</th><th>421</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $output;</span> </td>
                  </tr><tr>
                          <th>400</th><th>422</th><td class="l"><span></span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=60778438bb6d222fed293b44a127a22642c5b55a#L404">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L426">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>404</th><th>426</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $output = '';</span> </td>
                  </tr><tr>
                          <th>405</th><th>427</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset($this-&gt;emphasis)) {</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>406</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (list($amount, $state) = each($this-&gt;emphasis)) {</span> </td>
                      </tr><tr>
                        <th>407</th><th> </th><td class="l"><span>//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach ($this-&gt;emphasis as $amount=&gt;$state) {</span> </td>
                      </tr><tr>
                        <th>408</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($state) $output .= $this-&gt;emphasize($amount);</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>428</th><td class="r"><span>//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (list($amount, $state) = each($this-&gt;emphasis)) {</span> </td>
                      </tr><tr>
                        <th> </th><th>429</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach ($this-&gt;emphasis as $amount=&gt;$state) {</span> </td>
                      </tr><tr>
                        <th> </th><th>430</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($state) {</span> </td>
                      </tr><tr>
                        <th> </th><th>431</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $output .= $this-&gt;emphasize($amount);</span> </td>
                      </tr><tr>
                        <th> </th><th>432</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;emphasis[$amount] = FALSE;</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>433</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>409</th><th>434</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>410</th><th>435</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=60778438bb6d222fed293b44a127a22642c5b55a#L476">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/libraries/Wikiparser.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L501">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>476</th><th>501</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'special_quote'=&gt;'^"""(.*)"""\s*(.*)$',</span> </td>
                  </tr><tr>
                          <th>477</th><th>502</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'startparagraph'=&gt;'^([^\{\s\*\#;\:=-].*?)$',</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>478</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>'preformat'=&gt;'^\s(.*?)$',</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>503</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>//</ins>'preformat'=&gt;'^\s(.*?)$',</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>479</th><th>504</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'definitionlist'=&gt;'^([\;\:])\s*(.*?)$',</span> </td>
                  </tr><tr>
                          <th>480</th><th>505</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'newline'=&gt;'^$',</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file9">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/models/article_model.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/models/article_model.php">system/application/models/article_model.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 3a20d5000675c8828118fd8e92cf268a2d23b0cd">
                    <a title="Show revision 3a20d5000675c8828118fd8e92cf268a2d23b0cd of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/article_model.php?rev=3a20d5000675c8828118fd8e92cf268a2d23b0cd#L88">
                      r3a20d</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/article_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L88">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>88</th><th>88</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>89</th><th>89</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $result;</span> </td>
                  </tr>
            </tbody><tbody class="rem">
                  <tr class="first">
                          <th>90</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>91</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>92</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; // Gets all comments for a particular article whilst it is still accessible via News Office, assumes article_id exists</del> </td>
                  </tr><tr>
                          <th>93</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; function GetArticleComments ($article_id)</del> </td>
                  </tr><tr>
                          <th>94</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>95</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'SELECT comments.comment_id AS id,</del> </td>
                  </tr><tr>
                          <th>96</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;comments.comment_user_entity_id AS userid,</del> </td>
                  </tr><tr>
                          <th>97</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;comments.comment_text AS text,</del> </td>
                  </tr><tr>
                          <th>98</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UNIX_TIMESTAMP(comments.comment_timestamp) AS time,</del> </td>
                  </tr><tr>
                          <th>99</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;business_cards.business_card_name AS name</del> </td>
                  </tr><tr>
                          <th>100</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM comments, business_cards</del> </td>
                  </tr><tr>
                          <th>101</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE comments.comment_article_id = ?</del> </td>
                  </tr><tr>
                          <th>102</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND comments.comment_deleted = 0</del> </td>
                  </tr><tr>
                          <th>103</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND comments.comment_user_entity_id = business_cards.business_card_user_entity_id</del> </td>
                  </tr><tr>
                          <th>104</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ORDER BY comments.comment_timestamp DESC';</del> </td>
                  </tr><tr>
                          <th>105</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $this-&gt;db-&gt;query($sql, array($article_id));</del> </td>
                  </tr><tr>
                          <th>106</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result = array();</del> </td>
                  </tr><tr>
                          <th>107</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach ($query-&gt;result_array() as $row) {</del> </td>
                  </tr><tr>
                          <th>108</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result[] = $row;</del> </td>
                  </tr><tr>
                          <th>109</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>110</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $result;</del> </td>
                  </tr><tr>
                          <th>111</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>112</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>113</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; function InsertArticleComment ($article_id, $user_id, $comment)</del> </td>
                  </tr><tr>
                          <th>114</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>115</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'INSERT INTO comments</del> </td>
                  </tr><tr>
                          <th>116</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET comment_article_id = ?,</del> </td>
                  </tr><tr>
                          <th>117</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;comment_user_entity_id = ?,</del> </td>
                  </tr><tr>
                          <th>118</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;comment_text = ?';</del> </td>
                  </tr><tr>
                          <th>119</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $this-&gt;db-&gt;query($sql, array($article_id, $user_id, $comment));</del> </td>
                  </tr><tr>
                          <th>120</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'SELECT UNIX_TIMESTAMP(comments.comment_timestamp) AS time,</del> </td>
                  </tr><tr>
                          <th>121</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;business_cards.business_card_name AS name</del> </td>
                  </tr><tr>
                          <th>122</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM comments, business_cards</del> </td>
                  </tr><tr>
                          <th>123</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE comments.comment_user_entity_id = business_cards.business_card_user_entity_id</del> </td>
                  </tr><tr>
                          <th>124</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND comments.comment_id = ?';</del> </td>
                  </tr><tr>
                          <th>125</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $this-&gt;db-&gt;query($sql, array($this-&gt;db-&gt;insert_id()));</del> </td>
                  </tr><tr class="last">
                          <th>126</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $query-&gt;row_array();</del> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>127</th><th>90</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>128</th><th>91</th><td class="l"><span></span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file11">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/models/news_model.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/models/news_model.php">system/application/models/news_model.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision bb3bc55d90fa0a31380e3a1eaf5977c303245a07">
                    <a title="Show revision bb3bc55d90fa0a31380e3a1eaf5977c303245a07 of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/news_model.php?rev=bb3bc55d90fa0a31380e3a1eaf5977c303245a07#L369">
                      rbb3bc</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/news_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L369">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>369</th><th>369</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result['id'] = $id;</span> </td>
                  </tr><tr>
                          <th>370</th><th>370</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($preview == 0) {</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>371</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'SELECT articles.article_live_content_id,</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>371</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'SELECT</span> </td>
                      </tr><tr>
                        <th> </th><th>372</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; articles.article_live_content_id,</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>373</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; articles.article_public_comment_thread_id,</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>372</th><th>374</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DATE_FORMAT(articles.article_publish_date, ?) AS article_publish_date,</span> </td>
                  </tr><tr>
                          <th>373</th><th>375</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; articles.article_location_id</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/news_model.php?rev=bb3bc55d90fa0a31380e3a1eaf5977c303245a07#L380">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/news_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L382">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>380</th><th>382</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result['date'] = $row-&gt;article_publish_date;</span> </td>
                  </tr><tr>
                          <th>381</th><th>383</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result['location'] = $row-&gt;article_location_id;</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="last first">
                          <th> </th><th>384</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result['public_thread_id'] = $row-&gt;article_public_comment_thread_id;</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>382</th><th>385</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $content_id = $row-&gt;article_live_content_id;</span> </td>
                  </tr><tr>
                          <th>383</th><th>386</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</span> </td>
                  </tr><tr>
                          <th>384</th><th>387</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result['date'] = date('l, jS F Y');</span> </td>
                  </tr><tr>
                          <th>385</th><th>388</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result['location'] = 0;</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="last first">
                          <th> </th><th>389</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $result['public_thread_id'] = NULL;</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>386</th><th>390</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $content_id = $preview;</span> </td>
                  </tr><tr>
                          <th>387</th><th>391</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/news_model.php?rev=bb3bc55d90fa0a31380e3a1eaf5977c303245a07#L489">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/news_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L493">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>489</th><th>493</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $result;</span> </td>
                  </tr><tr>
                          <th>490</th><th>494</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>495</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>496</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; /// Get information about the public comments thread.</ins> </td>
                  </tr><tr>
                          <th> </th><th>497</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; /**</ins> </td>
                  </tr><tr>
                          <th> </th><th>498</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @param $ArticleId int ID of the article.</ins> </td>
                  </tr><tr>
                          <th> </th><th>499</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @pre loaded(model comments_model)</ins> </td>
                  </tr><tr>
                          <th> </th><th>500</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @return Same as comments_model::GetThreadByLinkTable</ins> </td>
                  </tr><tr>
                          <th> </th><th>501</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</ins> </td>
                  </tr><tr>
                          <th> </th><th>502</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; function GetPublicThread($ArticleId)</ins> </td>
                  </tr><tr>
                          <th> </th><th>503</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; {</ins> </td>
                  </tr><tr>
                          <th> </th><th>504</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $this-&gt;comments_model-&gt;GetThreadByLinkTable(</ins> </td>
                  </tr><tr>
                          <th> </th><th>505</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'articles','article_public_comment_thread_id',</ins> </td>
                  </tr><tr>
                          <th> </th><th>506</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array('article_id' =&gt; $ArticleId)</ins> </td>
                  </tr><tr>
                          <th> </th><th>507</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );</ins> </td>
                  </tr><tr>
                          <th> </th><th>508</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr>
                          <th> </th><th>509</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>510</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; /// Get information about the private comments thread.</ins> </td>
                  </tr><tr>
                          <th> </th><th>511</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; /**</ins> </td>
                  </tr><tr>
                          <th> </th><th>512</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @param $ArticleId int ID of the article.</ins> </td>
                  </tr><tr>
                          <th> </th><th>513</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @pre loaded(model comments_model)</ins> </td>
                  </tr><tr>
                          <th> </th><th>514</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @return Same as comments_model::GetThreadByLinkTable</ins> </td>
                  </tr><tr>
                          <th> </th><th>515</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</ins> </td>
                  </tr><tr>
                          <th> </th><th>516</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; function GetPrivateThread($ArticleId)</ins> </td>
                  </tr><tr>
                          <th> </th><th>517</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; {</ins> </td>
                  </tr><tr>
                          <th> </th><th>518</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $this-&gt;comments_model-&gt;GetThreadByLinkTable(</ins> </td>
                  </tr><tr>
                          <th> </th><th>519</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'articles','article_private_comment_thread_id',</ins> </td>
                  </tr><tr>
                          <th> </th><th>520</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array('article_id' =&gt; $ArticleId)</ins> </td>
                  </tr><tr>
                          <th> </th><th>521</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>522</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>491</th><th>523</th><td class="l"><span></span> </td>
                  </tr><tr>
                          <th>492</th><th>524</th><td class="l"><span>}</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file12">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/models/review_model.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/models/review_model.php">system/application/models/review_model.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision e90eada81b6f2137db32a4bf4c0b2cc0065c4d65">
                    <a title="Show revision e90eada81b6f2137db32a4bf4c0b2cc0065c4d65 of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L11">
                      re90ea</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L11">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>11</th><th>11</th><td class="l"><span>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : If tag_group_ordered is 1 for a tag group then order by tag_order, otherwise by tag_name</span> </td>
                  </tr><tr>
                          <th>12</th><th>12</th><td class="l"><span>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : 'star' and 'price' are names of tags, ordered by tag_order and tag_name respectively</span> </td>
                  </tr>
            </tbody><tbody class="rem">
                  <tr class="first">
                          <th>13</th><th> </th><td class="l"><del>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : user rating comes from a join like this (left join in case the the organisation is unrated):</del> </td>
                  </tr><tr>
                          <th>14</th><th> </th><td class="l"><del>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN comment_summary_cache</del> </td>
                  </tr><tr>
                          <th>15</th><th> </th><td class="l"><del>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON comment_summary_cache.comment_summary_cache_content_type_id = tag_groups.tag_group_content_type_id</del> </td>
                  </tr><tr>
                          <th>16</th><th> </th><td class="l"><del>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AND comment_summary_cache.comment_summary_cache_organisation_entity_id = organisations.organisation_entity_id</del> </td>
                  </tr><tr class="last">
                          <th>17</th><th> </th><td class="l"><del>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AND comment_summary_cache.comment_summary_cache_article_id IS NULL</del> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>18</th><th>13</th><td class="l"><span>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : I've added this in to your GetLeague function :-)</span> </td>
                  </tr><tr>
                          <th>19</th><th>14</th><td class="l"><span>**&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Get some sleep</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L303">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L298">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>303</th><th>298</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = '</span> </td>
                  </tr><tr>
                          <th>304</th><th>299</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SELECT</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>305</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; organisations.organisation_name,</span> </td>
                      </tr><tr>
                        <th>306</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; organisation_contents.organisation_content_url,</span> </td>
                      </tr><tr>
                        <th>307</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; review_context_contents.review_context_content_blurb as organisation_description,</span> </td>
                      </tr><tr>
                        <th>308</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; review_context_contents.review_context_content_rating,</span> </td>
                      </tr><tr>
                        <th>309</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; organisations.organisation_directory_entry_name,</span> </td>
                      </tr><tr>
                        <th>310</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; league_entries.league_entry_position,</span> </td>
                      </tr><tr>
                        <th>311</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leagues.league_name,</span> </td>
                      </tr><tr>
                        <th>312</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leagues.league_image_id,</span> </td>
                      </tr><tr>
                        <th>313</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; content_types.content_type_name,</span> </td>
                      </tr><tr>
                        <th>314</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; content_types.content_type_codename,</span> </td>
                      </tr><tr>
                        <th>315</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; comment_summary_cache.comment_summary_cache_average_rating</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>300</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; organisations.organisation_name,</span> </td>
                      </tr><tr>
                        <th> </th><th>301</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; organisation_contents.organisation_content_url,</span> </td>
                      </tr><tr>
                        <th> </th><th>302</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; review_context_contents.review_context_content_blurb as organisation_description,</span> </td>
                      </tr><tr>
                        <th> </th><th>303</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; review_context_contents.review_context_content_rating,</span> </td>
                      </tr><tr>
                        <th> </th><th>304</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; organisations.organisation_directory_entry_name,</span> </td>
                      </tr><tr>
                        <th> </th><th>305</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; league_entries.league_entry_position,</span> </td>
                      </tr><tr>
                        <th> </th><th>306</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leagues.league_name,</span> </td>
                      </tr><tr>
                        <th> </th><th>307</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leagues.league_image_id,</span> </td>
                      </tr><tr>
                        <th> </th><th>308</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; content_types.content_type_name,</span> </td>
                      </tr><tr>
                        <th> </th><th>309</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; content_types.content_type_codename,</span> </td>
                      </tr><tr>
                        <th> </th><th>310</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF (thread.comment_thread_num_ratings &gt; 0,</span> </td>
                      </tr><tr>
                        <th> </th><th>311</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thread.comment_thread_total_rating / thread.comment_thread_num_ratings,</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>312</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL) AS average_user_rating</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>316</th><th>313</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM content_types</span> </td>
                  </tr><tr>
                          <th>317</th><th>314</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN review_context_contents</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>318</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>ON review_context_contents.review_context_content_content_type_id = content_types.content_type_id</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>315</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>ON review_context_contents.review_context_content_content_type_id = content_types.content_type_id</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>319</th><th>316</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN organisations</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>320</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>ON organisations.organisation_entity_id = review_context_contents.review_context_content_organisation_entity_id</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>317</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>ON organisations.organisation_entity_id = review_context_contents.review_context_content_organisation_entity_id</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>321</th><th>318</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN organisation_contents </span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>322</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>ON organisations.organisation_live_content_id = organisation_contents.organisation_content_id </span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>319</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>&nbsp; &nbsp; </ins>ON organisations.organisation_live_content_id = organisation_contents.organisation_content_id </span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>323</th><th>320</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN league_entries</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>324</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>ON league_entries.league_entry_organisation_entity_id = organisations.organisation_entity_id</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>321</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>ON league_entries.league_entry_organisation_entity_id = organisations.organisation_entity_id</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>325</th><th>322</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN leagues</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>326</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON leagues.league_id = league_entries.league_entry_league_id AND content_types.content_type_id = leagues.league_content_type_id</span> </td>
                      </tr><tr>
                        <th>327</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN comment_summary_cache</span> </td>
                      </tr><tr>
                        <th>328</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON comment_summary_cache.comment_summary_cache_content_type_id = content_types.content_type_id</span> </td>
                      </tr><tr>
                        <th>329</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AND comment_summary_cache.comment_summary_cache_organisation_entity_id = organisations.organisation_entity_id</span> </td>
                      </tr><tr>
                        <th>330</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;AND comment_summary_cache.comment_summary_cache_article_id IS NULL</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>323</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON leagues.league_id = league_entries.league_entry_league_id</span> </td>
                      </tr><tr>
                        <th> </th><th>324</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND content_types.content_type_id = leagues.league_content_type_id</span> </td>
                      </tr><tr>
                        <th> </th><th>325</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN review_contexts</span> </td>
                      </tr><tr>
                        <th> </th><th>326</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON review_contexts.review_context_organisation_entity_id = organisations.organisation_entity_id</span> </td>
                      </tr><tr>
                        <th> </th><th>327</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND review_contexts.review_context_content_type_id = content_types.content_type_id</span> </td>
                      </tr><tr>
                        <th> </th><th>328</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN comment_threads</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>329</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON comment_threads.comment_thread_id = review_contexts.review_context_comment_thread_id</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>331</th><th>330</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE leagues.league_codename = ?</span> </td>
                  </tr><tr>
                          <th>332</th><th>331</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ORDER BY ? ?</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L347">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L346">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>347</th><th>346</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpleague['review_rating'] = $row-&gt;review_context_content_rating;</span> </td>
                  </tr><tr>
                          <th>348</th><th>347</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpleague['average_user_rating'] = 0;</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>349</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($row-&gt;<del>comment_summary_cache_average</del>_rating != '')</span> </td>
                      </tr><tr>
                        <th>350</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpleague['average_user_rating']&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $row-&gt;<del>comment_summary_cache_average</del>_rating;</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>348</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($row-&gt;<ins>average_user</ins>_rating != '')</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>349</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpleague['average_user_rating']&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $row-&gt;<ins>average_user</ins>_rating;</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>351</th><th>350</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $tmpleague['organisation_directory_entry_name'] = $row-&gt;organisation_directory_entry_name;</span> </td>
                  </tr><tr>
                          <th>352</th><th>351</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $league[]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = $tmpleague;</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L492">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L491">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>492</th><th>491</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $user = $query[0]['user_firstname'].' '.$query[0]['user_surname'];</span> </td>
                  </tr><tr>
                          <th>493</th><th>492</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $user;</span> </td>
                  </tr>
            </tbody><tbody class="rem">
                  <tr class="first">
                          <th>494</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>495</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>496</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; //Gets comments from database, frb501</del> </td>
                  </tr><tr>
                          <th>497</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; function GetComments($organisation_name, $type, $article_id)</del> </td>
                  </tr><tr>
                          <th>498</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>499</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = "SELECT comment_id, comment_text, comment_timestamp, comment_user_entity_id, comment_rating, comment_reported_count FROM comments WHERE comment_organisation_entity_id = ? AND comment_content_type_id = ? AND comment_article_id = ? AND comment_deleted = 0 ORDER BY comment_timestamp DESC";</del> </td>
                  </tr><tr>
                          <th>500</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $this-&gt;db-&gt;query($sql,array($this-&gt;FindOrganisationID($organisation_name),$type,$article_id));</del> </td>
                  </tr><tr>
                          <th>501</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>502</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($query-&gt;num_rows() &gt; 0)</del> </td>
                  </tr><tr>
                          <th>503</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>504</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $commentno = 0;</del> </td>
                  </tr><tr>
                          <th>505</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach ($query-&gt;result() as $row)</del> </td>
                  </tr><tr>
                          <th>506</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>507</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments[$commentno]['comment_author'] = $this-&gt;TranslateUserIDToName($row-&gt;comment_user_entity_id);</del> </td>
                  </tr><tr>
                          <th>508</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments[$commentno]['comment_id'] = $row-&gt;comment_id;</del> </td>
                  </tr><tr>
                          <th>509</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments[$commentno]['comment_rating'] = $row-&gt;comment_rating;</del> </td>
                  </tr><tr>
                          <th>510</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments[$commentno]['comment_date'] = $row-&gt;comment_timestamp;</del> </td>
                  </tr><tr>
                          <th>511</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments[$commentno]['comment_content'] = $row-&gt;comment_text;</del> </td>
                  </tr><tr>
                          <th>512</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments[$commentno]['comment_reported_count'] = $row-&gt;comment_reported_count;</del> </td>
                  </tr><tr>
                          <th>513</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $commentno++;</del> </td>
                  </tr><tr>
                          <th>514</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>515</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>516</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $comments;</del> </td>
                  </tr><tr>
                          <th>517</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>518</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else</del> </td>
                  </tr><tr>
                          <th>519</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>520</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $nocomments = array();</del> </td>
                  </tr><tr>
                          <th>521</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $nocomments;</del> </td>
                  </tr><tr class="last">
                          <th>522</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>523</th><th>493</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>524</th><th>494</th><td class="l"><span></span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L602">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L572">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>602</th><th>572</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Return the result</span> </td>
                  </tr><tr>
                          <th>603</th><th>573</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $tag_group;</span> </td>
                  </tr>
            </tbody><tbody class="rem">
                  <tr class="first">
                          <th>604</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>605</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>606</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; function ReportComment($comment_id)</del> </td>
                  </tr><tr>
                          <th>607</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>608</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'SELECT comment_reported_count FROM comments WHERE comment_id = ?';</del> </td>
                  </tr><tr>
                          <th>609</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $this-&gt;db-&gt;query($sql,$comment_id);</del> </td>
                  </tr><tr>
                          <th>610</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $query-&gt;result_array();</del> </td>
                  </tr><tr>
                          <th>611</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $query[0]['comment_reported_count'];</del> </td>
                  </tr><tr>
                          <th>612</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $newcount = $query + 1;</del> </td>
                  </tr><tr>
                          <th>613</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'UPDATE comments SET comment_reported_count = ? WHERE comment_id = ?';</del> </td>
                  </tr><tr class="last">
                          <th>614</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;db-&gt;query($sql,array($newcount,$comment_id));</del> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>615</th><th>574</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>616</th><th>575</th><td class="l"><span></span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L820">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L779">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>820</th><th>779</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>821</th><th>780</th><td class="l"><span></span> </td>
                  </tr>
            </tbody><tbody class="rem">
                  <tr class="first">
                          <th>822</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; //Gets the current average user rating for a article</del> </td>
                  </tr><tr>
                          <th>823</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; function GetUserRating($article_id)</del> </td>
                  </tr><tr>
                          <th>824</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>825</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'SELECT comment_summary_cache_comment_count,comment_summary_cache_average_rating FROM comment_summary_cache WHERE comment_summary_cache_article_id = ?';</del> </td>
                  </tr><tr>
                          <th>826</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $this-&gt;db-&gt;query($sql,$article_id);</del> </td>
                  </tr><tr>
                          <th>827</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($query-&gt;result_array() == array()) return 0; //Not rated yet</del> </td>
                  </tr><tr>
                          <th>828</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>829</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $query-&gt;result_array();</del> </td>
                  </tr><tr>
                          <th>830</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $query[0];</del> </td>
                  </tr><tr>
                          <th>831</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>832</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return array($query['comment_summary_cache_average_rating'],$query['comment_summary_cache_comment_count']);</del> </td>
                  </tr><tr>
                          <th>833</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>834</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>835</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; //Adds a comment to the database, frb501</del> </td>
                  </tr><tr>
                          <th>836</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; function SetComment($post_data)</del> </td>
                  </tr><tr>
                          <th>837</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>838</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comment['comment_content_type_id'] = $post_data['comment_type_id'];</del> </td>
                  </tr><tr>
                          <th>839</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comment['comment_organisation_entity_id'] = $post_data['comment_organisation_id'];</del> </td>
                  </tr><tr>
                          <th>840</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comment['comment_article_id'] = $post_data['comment_article_id'];</del> </td>
                  </tr><tr>
                          <th>841</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comment['comment_user_entity_id'] = $post_data['comment_user_entity_id'];</del> </td>
                  </tr><tr>
                          <th>842</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comment['comment_text'] = $post_data['comment_text'];</del> </td>
                  </tr><tr>
                          <th>843</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comment['comment_rating'] = $post_data['comment_rating'];</del> </td>
                  </tr><tr>
                          <th>844</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;db-&gt;insert('comments',$comment); //Add users comment to database</del> </td>
                  </tr><tr>
                          <th>845</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>846</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //Set cache table</del> </td>
                  </tr><tr>
                          <th>847</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'SELECT comment_rating FROM comments WHERE comment_article_id = ?';</del> </td>
                  </tr><tr>
                          <th>848</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $query = $this-&gt;db-&gt;query($sql,$comment['comment_article_id']);</del> </td>
                  </tr><tr>
                          <th>849</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ($query-&gt;result_array() == array()) return 0; //Not rated yet</del> </td>
                  </tr><tr>
                          <th>850</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>851</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $num = 0; $sum = 0;</del> </td>
                  </tr><tr>
                          <th>852</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>853</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach ($query-&gt;result_array() as $row)</del> </td>
                  </tr><tr>
                          <th>854</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>855</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $num++;</del> </td>
                  </tr><tr>
                          <th>856</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sum += $row['comment_rating'];</del> </td>
                  </tr><tr>
                          <th>857</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>858</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>859</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $average_rating = ceil($sum / $num);</del> </td>
                  </tr><tr>
                          <th>860</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>861</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'INSERT INTO comment_summary_cache (comment_summary_cache_content_type_id&nbsp; &nbsp; &nbsp; &nbsp; ,comment_summary_cache_organisation_entity_id,comment_summary_cache_article_id,comment_summary_cache_comment_count,comment_summary_cache_average_rating) VALUES(?,?,?,?,?) ON DUPLICATE KEY UPDATE comment_summary_cache_comment_count = ?, comment_summary_cache_average_rating = ?';</del> </td>
                  </tr><tr>
                          <th>862</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>863</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;db-&gt;query($sql,array($comment['comment_content_type_id'],$comment['comment_organisation_entity_id'],$comment['comment_article_id'],$num,$average_rating,$num,$average_rating));</del> </td>
                  </tr><tr>
                          <th>864</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>865</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr>
                          <th>866</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; //Logically deletes a comment from the database</del> </td>
                  </tr><tr>
                          <th>867</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; function DeleteComment($comment_id)</del> </td>
                  </tr><tr>
                          <th>868</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; {</del> </td>
                  </tr><tr>
                          <th>869</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = 'UPDATE comments SET comment_deleted = 1 WHERE comment_id = ?';</del> </td>
                  </tr><tr>
                          <th>870</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;db-&gt;query($sql,$comment_id);</del> </td>
                  </tr><tr>
                          <th>871</th><th> </th><td class="l"><del>&nbsp; &nbsp; &nbsp; &nbsp; }</del> </td>
                  </tr><tr>
                          <th>872</th><th> </th><td class="l"><del></del> </td>
                  </tr><tr class="last">
                          <th>873</th><th> </th><td class="l"><del></del> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>874</th><th>781</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; //Gets a table review for a section which is sorted depending on parameters</span> </td>
                  </tr><tr>
                          <th>875</th><th>782</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; function GetTableReview($content_type_codename,$sorted_by = 'any',$item_filter_by = 'any',$where_equal_to = 'any')</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L890">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L797">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>890</th><th>797</th><td class="l"><span></span> </td>
                  </tr><tr>
                          <th>891</th><th>798</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 'user':</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>892</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sort_sql = 'ORDER BY csc.comment_summary_cache_average_rating DESC, ';</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>799</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sort_sql = 'ORDER BY IF (thread.comment_thread_num_ratings &gt; 0,</span> </td>
                      </tr><tr>
                        <th> </th><th>800</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thread.comment_thread_total_rating / thread.comment_thread_num_ratings,</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>801</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL) DESC, ';</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>893</th><th>802</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span> </td>
                  </tr><tr>
                          <th>894</th><th>803</th><td class="l"><span></span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L899">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L808">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>899</th><th>808</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:</span> </td>
                  </tr><tr>
                          <th>900</th><th>809</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sort_sql = 'ORDER BY correct_tag, t.tag_name, ';</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>901</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $escaped_tag_group_name = mysql_real_escape_string($sorted_by);</span> </td>
                      </tr><tr>
                        <th>902</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $select_tag_group = ", IF(tg.tag_group_name ='".$escaped_tag_group_name."',0,1) AS correct_tag";</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>810</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $select_tag_group = ', IF(tg.tag_group_name ='.$this-&gt;db-&gt;escape($sorted_by).',0,1) AS correct_tag';</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>903</th><th>811</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</span> </td>
                  </tr><tr>
                          <th>904</th><th>812</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr><tr>
                          <th>905</th><th>813</th><td class="l"><span></span> </td>
                  </tr><tr>
                          <th>906</th><th>814</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sql = '</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>907</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SELECT o.organisation_entity_id, o.organisation_name, oc.organisation_content_url, o.organisation_directory_entry_name,tg.tag_group_name,t.tag_name,</span> </td>
                      </tr><tr>
                        <th>908</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rcc.review_context_content_rating, csc.comment_summary_cache_average_rating'.$select_tag_group.'</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>815</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SELECT</span> </td>
                      </tr><tr>
                        <th> </th><th>816</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.organisation_entity_id,</span> </td>
                      </tr><tr>
                        <th> </th><th>817</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.organisation_name,</span> </td>
                      </tr><tr>
                        <th> </th><th>818</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; oc.organisation_content_url,</span> </td>
                      </tr><tr>
                        <th> </th><th>819</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; o.organisation_directory_entry_name,</span> </td>
                      </tr><tr>
                        <th> </th><th>820</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tg.tag_group_name,t.tag_name,</span> </td>
                      </tr><tr>
                        <th> </th><th>821</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rcc.review_context_content_rating,</span> </td>
                      </tr><tr>
                        <th> </th><th>822</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF (thread.comment_thread_num_ratings &gt; 0,</span> </td>
                      </tr><tr>
                        <th> </th><th>823</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thread.comment_thread_total_rating / thread.comment_thread_num_ratings,</span> </td>
                      </tr><tr>
                        <th> </th><th>824</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL) AS average_user_rating'.</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>825</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $select_tag_group.'</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>909</th><th>826</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM content_types AS ct</span> </td>
                  </tr><tr>
                          <th>910</th><th>827</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN review_context_contents AS rcc</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>911</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>ON ct.content_type_id = rcc.review_context_content_content_type_id</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>828</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>ON ct.content_type_id = rcc.review_context_content_content_type_id</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>912</th><th>829</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN organisations AS o</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>913</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>ON rcc.review_context_content_organisation_entity_id = o.organisation_entity_id</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>830</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>ON rcc.review_context_content_organisation_entity_id = o.organisation_entity_id</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>914</th><th>831</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN organisation_contents AS oc</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>915</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON o.organisation_live_content_id = oc.organisation_content_id</span> </td>
                      </tr><tr>
                        <th>916</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN comment_summary_cache AS csc</span> </td>
                      </tr><tr>
                        <th>917</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON csc.comment_summary_cache_content_type_id = ct.content_type_id</span> </td>
                      </tr><tr>
                        <th>918</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND csc.comment_summary_cache_organisation_entity_id = o.organisation_entity_id </span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>832</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON o.organisation_live_content_id = oc.organisation_content_id</span> </td>
                      </tr><tr>
                        <th> </th><th>833</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN review_contexts</span> </td>
                      </tr><tr>
                        <th> </th><th>834</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON review_contexts.review_context_organisation_entity_id = o.organisation_entity_id</span> </td>
                      </tr><tr>
                        <th> </th><th>835</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND review_contexts.review_context_content_type_id = ct.content_type_id</span> </td>
                      </tr><tr>
                        <th> </th><th>836</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN comment_threads AS thread</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>837</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ON thread.comment_thread_id = review_contexts.review_context_comment_thread_id </span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>919</th><th>838</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN organisation_tags AS ot ON ot.organisation_tag_organisation_entity_id = o.organisation_entity_id </span> </td>
                  </tr><tr>
                          <th>920</th><th>839</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN tags AS t</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>921</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>ON t.tag_id = ot.organisation_tag_tag_id</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>840</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>ON t.tag_id = ot.organisation_tag_tag_id</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>922</th><th>841</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INNER JOIN tag_groups AS tg</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>923</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <del></del>ON tg.tag_group_id = t.tag_tag_group_id</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>842</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins>ON tg.tag_group_id = t.tag_tag_group_id</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>924</th><th>843</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LEFT JOIN tags ON tags.tag_id = ot.organisation_tag_tag_id </span> </td>
                  </tr><tr>
                          <th>925</th><th>844</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE ct.content_type_codename = ? '.$sort_sql.'tg.tag_group_order ASC, t.tag_order ASC';</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=e90eada81b6f2137db32a4bf4c0b2cc0065c4d65#L1077">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/models/review_model.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L996">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>1077</th><th>996</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; return $bar_list;</span> </td>
                  </tr><tr>
                          <th>1078</th><th>997</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>998</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>999</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>1000</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; /// Get information about the private comments thread.</ins> </td>
                  </tr><tr>
                          <th> </th><th>1001</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; /**</ins> </td>
                  </tr><tr>
                          <th> </th><th>1002</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @param $OrganisationId int ID of the organisation.</ins> </td>
                  </tr><tr>
                          <th> </th><th>1003</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @param $ContentTypeId int ID of the content type.</ins> </td>
                  </tr><tr>
                          <th> </th><th>1004</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @pre loaded(model comments_model)</ins> </td>
                  </tr><tr>
                          <th> </th><th>1005</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @return Same as comments_model::GetThreadByLinkTable</ins> </td>
                  </tr><tr>
                          <th> </th><th>1006</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</ins> </td>
                  </tr><tr>
                          <th> </th><th>1007</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; function GetReviewContextCommentThread($OrganisationId, $ContentTypeId)</ins> </td>
                  </tr><tr>
                          <th> </th><th>1008</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; {</ins> </td>
                  </tr><tr>
                          <th> </th><th>1009</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $this-&gt;comments_model-&gt;GetThreadByLinkTable(</ins> </td>
                  </tr><tr>
                          <th> </th><th>1010</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'review_contexts','review_context_comment_thread_id',</ins> </td>
                  </tr><tr>
                          <th> </th><th>1011</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</ins> </td>
                  </tr><tr>
                          <th> </th><th>1012</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'review_context_organisation_entity_id' =&gt; $OrganisationId,</ins> </td>
                  </tr><tr>
                          <th> </th><th>1013</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'review_context_content_type_id'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; $ContentTypeId,</ins> </td>
                  </tr><tr>
                          <th> </th><th>1014</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</ins> </td>
                  </tr><tr>
                          <th> </th><th>1015</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>1016</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>1079</th><th>1017</th><td class="l"><span></span> </td>
                  </tr><tr>
                          <th>1080</th><th>1018</th><td class="l"><span>}</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file18">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/views/news/news.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/views/news/news.php">system/application/views/news/news.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision b777020f64720bc73bc127fc8a43ee49ad64e80d">
                    <a title="Show revision b777020f64720bc73bc127fc8a43ee49ad64e80d of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/news/news.php?rev=b777020f64720bc73bc127fc8a43ee49ad64e80d#L83">
                      rb7770</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/news/news.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L83">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>83</th><th>83</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span> </td>
                  </tr><tr>
                          <th>84</th><th>84</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;?php } ?&gt;</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>85</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &lt;?php</ins> </td>
                  </tr><tr>
                          <th> </th><th>86</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; // Comments if they're included</ins> </td>
                  </tr><tr>
                          <th> </th><th>87</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; if (isset($comments) &amp;&amp; NULL !== $comments) {</ins> </td>
                  </tr><tr>
                          <th> </th><th>88</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments-&gt;Load();&nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr><tr>
                          <th> </th><th>89</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; }</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>90</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; ?&gt;</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>85</th><th>91</th><td class="l"><span>&lt;/div&gt;</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file19">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/views/office/news/article.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/views/office/news/article.php">system/application/views/office/news/article.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision ca124736aac2460c6b5126aa6655b22d1badc145">
                    <a title="Show revision ca124736aac2460c6b5126aa6655b22d1badc145 of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/office/news/article.php?rev=ca124736aac2460c6b5126aa6655b22d1badc145#L244">
                      rca124</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/office/news/article.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L244">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>244</th><th>244</th><td class="l"><span></span> </td>
                  </tr><tr>
                          <th>245</th><th>245</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div id="content_comments" class="hide"&gt;</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>246</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;<del></del>div class="blue_box"&gt;</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>246</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;<ins>?php /*&lt;</ins>div class="blue_box"&gt;</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>247</th><th>247</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;h2&gt;comments...&lt;/h2&gt;</span> </td>
                  </tr><tr>
                          <th>248</th><th>248</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div id="comment_load" class="ajax_loading hide"&gt;</span> </td>
                  </tr>
            </tbody>
              <tbody class="skipped">
                <tr>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/office/news/article.php?rev=ca124736aac2460c6b5126aa6655b22d1badc145#L271">…</a></th>
                  <th><a href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/office/news/article.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L271">…</a></th>
                  <td> </td>
                </tr>
              </tbody>
            <tbody class="unmod">
                  <tr>
                          <th>271</th><th>271</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;?php } ?&gt;</span> </td>
                  </tr><tr>
                          <th>272</th><th>272</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>273</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>273</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt; */ ?&gt;</span> </td>
                      </tr><tr>
                        <th> </th><th>274</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;?php</span> </td>
                      </tr><tr>
                        <th> </th><th>275</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Comments if they're included</span> </td>
                      </tr><tr>
                        <th> </th><th>276</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (isset($comments) &amp;&amp; NULL !== $comments) {</span> </td>
                      </tr><tr>
                        <th> </th><th>277</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments-&gt;Load();&nbsp; &nbsp; &nbsp; </span> </td>
                      </tr><tr>
                        <th> </th><th>278</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>279</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?&gt;</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>274</th><th>280</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span> </td>
                  </tr><tr>
                          <th>275</th><th>281</th><td class="l"><span></span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file20">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/application/views/reviews/mainreview.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/application/views/reviews/mainreview.php">system/application/views/reviews/mainreview.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 546de97daff2ac9f21056be93852e93dc2471ba3">
                    <a title="Show revision 546de97daff2ac9f21056be93852e93dc2471ba3 of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/reviews/mainreview.php?rev=546de97daff2ac9f21056be93852e93dc2471ba3#L78">
                      r546de</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/application/views/reviews/mainreview.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L78">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>78</th><th>78</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span> </td>
                  </tr><tr>
                          <th>79</th><th>79</th><td class="l"><span></span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>80</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="BlueBox"&gt;</span> </td>
                      </tr><tr>
                        <th>81</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;h2&gt;your comments&lt;/h2&gt;</span> </td>
                      </tr><tr>
                        <th>82</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;p&gt;</span> </td>
                      </tr><tr>
                        <th>83</th><th> </th><td class="l"><span>&lt;?php</span> </td>
                      </tr><tr>
                        <th>84</th><th> </th><td class="l"><span>echo('&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ');</span> </td>
                      </tr><tr>
                        <th>85</th><th> </th><td class="l"><span>if ($user_rating == null)</span> </td>
                      </tr><tr>
                        <th>86</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; echo('No one has rated this place yet, you could be the first!');</span> </td>
                      </tr><tr>
                        <th>87</th><th> </th><td class="l"><span>else</span> </td>
                      </tr><tr>
                        <th>88</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; echo('User Rating: '.$user_rating.'/10 (based on '.$user_based.' votes)');</span> </td>
                      </tr><tr>
                        <th>89</th><th> </th><td class="l"><span>?&gt;</span> </td>
                      </tr><tr>
                        <th>90</th><th> </th><td class="l"><span></span> </td>
                      </tr><tr>
                        <th>91</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/p&gt;</span> </td>
                      </tr><tr>
                        <th>92</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;hr /&gt;</span> </td>
                      </tr><tr>
                        <th>93</th><th> </th><td class="l"><span>&lt;?php</span> </td>
                      </tr><tr>
                        <th>94</th><th> </th><td class="l"><span>for ($i = 0; ($i &lt; 5 || $this-&gt;uri-&gt;segment(4) == 'all') &amp; $i &lt; count($comments); $i++) {</span> </td>
                      </tr><tr>
                        <th>95</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; echo('&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;h3&gt;'.htmlentities($comments[$i]['comment_author']));</span> </td>
                      </tr><tr>
                        <th>96</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; echo(' | '.htmlentities($comments[$i]['comment_date']));</span> </td>
                      </tr><tr>
                        <th>97</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; echo(' |&nbsp; &lt;a href="/reviews/reportcomment/'.$comments[$i]['comment_id'].'"&gt;Report&lt;/a&gt;&lt;/h3&gt;'."\n");</span> </td>
                      </tr><tr>
                        <th>98</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; echo('&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;p&gt;'.htmlentities($comments[$i]['comment_content']).'&lt;/p&gt;'."\n");</span> </td>
                      </tr><tr>
                        <th>99</th><th> </th><td class="l"><span>}</span> </td>
                      </tr><tr>
                        <th>100</th><th> </th><td class="l"><span></span> </td>
                      </tr><tr>
                        <th>101</th><th> </th><td class="l"><span>if ($this-&gt;uri-&gt;segment(4) != 'all')</span> </td>
                      </tr><tr>
                        <th>102</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; echo('&lt;p&gt;&lt;a href='.$this-&gt;uri-&gt;uri_string().'/all&gt;View all comments&lt;/a&gt;&lt;/p&gt;');</span> </td>
                      </tr><tr>
                        <th>103</th><th> </th><td class="l"><span></span> </td>
                      </tr><tr>
                        <th>104</th><th> </th><td class="l"><span>if (!$this-&gt;user_auth-&gt;isLoggedIn) {</span> </td>
                      </tr><tr>
                        <th>105</th><th> </th><td class="l"><span>?&gt;</span> </td>
                      </tr><tr>
                        <th>106</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;p&gt;Please &lt;a href="/login/main&lt;?php echo($this-&gt;uri-&gt;uri_string()); ?&gt;"&gt;log in&lt;/a&gt; to add comments&lt;/p&gt;</span> </td>
                      </tr><tr>
                        <th>107</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span> </td>
                      </tr><tr>
                        <th>108</th><th> </th><td class="l"><span>&lt;?php</span> </td>
                      </tr><tr>
                        <th>109</th><th> </th><td class="l"><span>} else {</span> </td>
                      </tr><tr>
                        <th>110</th><th> </th><td class="l"><span>?&gt;</span> </td>
                      </tr><tr>
                        <th>111</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span> </td>
                      </tr><tr>
                        <th>112</th><th> </th><td class="l"><span></span> </td>
                      </tr><tr>
                        <th>113</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="BlueBox"&gt;</span> </td>
                      </tr><tr>
                        <th>114</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;h2&gt;add comment&lt;/h2&gt;</span> </td>
                      </tr><tr>
                        <th>115</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;form action="/reviews/addcomment" method="post"&gt;</span> </td>
                      </tr><tr>
                        <th>116</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;fieldset&gt;</span> </td>
                      </tr><tr>
                        <th>117</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="hidden" name="comment_type_id" value="&lt;?php echo($type_id); ?&gt;" /&gt;</span> </td>
                      </tr><tr>
                        <th>118</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="hidden" name="comment_organisation_id" value="&lt;?php echo($organisation_id); ?&gt;" /&gt;</span> </td>
                      </tr><tr>
                        <th>119</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="hidden" name="comment_article_id" value="&lt;?php echo($article_id[0]); ?&gt;" /&gt;</span> </td>
                      </tr><tr>
                        <th>120</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="hidden" name="comment_user_entity_id" value="&lt;?php echo($this-&gt;user_auth-&gt;entityId); ?&gt;" /&gt;</span> </td>
                      </tr><tr>
                        <th>121</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="hidden" name="return_page" value="&lt;?php echo($this-&gt;uri-&gt;uri_string()) ?&gt;" /&gt;</span> </td>
                      </tr><tr>
                        <th>122</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;label for="comment_text"&gt;Comments: &lt;/label&gt;</span> </td>
                      </tr><tr>
                        <th>123</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;textarea name="comment_text"&gt;&lt;/textarea&gt;&lt;br /&gt;</span> </td>
                      </tr><tr>
                        <th>124</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;label for="comment_rating"&gt;Rating: &lt;/label&gt;</span> </td>
                      </tr><tr>
                        <th>125</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;select name="comment_rating"&gt;</span> </td>
                      </tr><tr>
                        <th>126</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;1&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>127</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;2&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>128</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;3&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>129</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;4&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>130</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;5&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>131</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;6&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>132</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;7&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>133</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;8&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>134</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;9&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>135</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;option&gt;10&lt;/option&gt;</span> </td>
                      </tr><tr>
                        <th>136</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/select&gt;</span> </td>
                      </tr><tr>
                        <th>137</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/fieldset&gt;</span> </td>
                      </tr><tr>
                        <th>138</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;fieldset&gt;</span> </td>
                      </tr><tr>
                        <th>139</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="submit" value="AddComment" class="button" /&gt;</span> </td>
                      </tr><tr>
                        <th>140</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/fieldset&gt;</span> </td>
                      </tr><tr>
                        <th>141</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/form&gt;</span> </td>
                      </tr><tr>
                        <th>142</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</span> </td>
                      </tr><tr>
                        <th>143</th><th> </th><td class="l"><span>&lt;?php</span> </td>
                      </tr><tr>
                        <th>144</th><th> </th><td class="l"><span>}</span> </td>
                      </tr><tr>
                        <th>145</th><th> </th><td class="l"><span>?&gt;</span> </td>
                      </tr>
                      <tr>
                        <th> </th><th>80</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &lt;?php</span> </td>
                      </tr><tr>
                        <th> </th><th>81</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; if (isset($comments) &amp;&amp; NULL !== $comments) {</span> </td>
                      </tr><tr>
                        <th> </th><th>82</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $comments-&gt;Load();</span> </td>
                      </tr><tr>
                        <th> </th><th>83</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                      </tr><tr class="last">
                        <th> </th><th>84</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; ?&gt;</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>146</th><th>85</th><td class="l"><span>&lt;/div&gt;</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
      <li class="entry">
        <h2 id="file22">
          <a title="Show the changeset b898331d5e5550775358c4e1853c0bae324e302c restricted to system/libraries/Router.php" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c/system/libraries/Router.php">system/libraries/Router.php</a>
        </h2>
        <table class="inline" summary="Differences" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Revision 193a88b321b528c60455d580fd9b312d0db99f31">
                    <a title="Show revision 193a88b321b528c60455d580fd9b312d0db99f31 of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/libraries/Router.php?rev=193a88b321b528c60455d580fd9b312d0db99f31#L253">
                      r193a8</a>
                  </th>
                  <th title="Revision b898331d5e5550775358c4e1853c0bae324e302c">
                    <a title="Show revision b898331d5e5550775358c4e1853c0bae324e302c of this file in browser" href="http://dev2.theyorker.co.uk/trac/browser/system/libraries/Router.php?rev=b898331d5e5550775358c4e1853c0bae324e302c#L253">
                      rb8983</a>
                  </th>
                  <th> </th>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>253</th><th>253</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; function _reindex_segments()</span> </td>
                  </tr><tr>
                          <th>254</th><th>254</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; {</span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>255</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /**</ins> </td>
                  </tr><tr>
                          <th> </th><th>256</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* @note Altered by James Hogan (jh559@cs.york.ac.uk).</ins> </td>
                  </tr><tr>
                          <th> </th><th>257</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; The previous use of array_dif was incorrect and didn't test for</ins> </td>
                  </tr><tr>
                          <th> </th><th>258</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; array equality properly. The urls /test/james/test and /james/test</ins> </td>
                  </tr><tr>
                          <th> </th><th>259</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; were considered equal because neither has segments the other</ins> </td>
                  </tr><tr>
                          <th> </th><th>260</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; doensn't.</ins> </td>
                  </tr><tr>
                          <th> </th><th>261</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>262</th><td class="r"><ins>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>255</th><th>263</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Is the routed segment array different then the main segment array?</span> </td>
                  </tr>
            </tbody><tbody class="mod">
                      <tr class="first">
                        <th>256</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (count(array_diff($this-&gt;rsegments, $this-&gt;segments))==0 AND count(array_diff($this-&gt;segments, $this-&gt;rsegments))==0){ </span> </td>
                      </tr><tr>
                        <th>257</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $diff = FALSE;</span> </td>
                      </tr><tr>
                        <th>258</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {</span> </td>
                      </tr><tr>
                        <th>259</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $diff = TRUE;</span> </td>
                      </tr><tr>
                        <th>260</th><th> </th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span> </td>
                      </tr>
                      <tr class="last">
                        <th> </th><th>264</th><td class="r"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $diff = ($this-&gt;rsegments != $this-&gt;segments);</span> </td>
                      </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>261</th><th>265</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; </span> </td>
                  </tr><tr>
                          <th>262</th><th>266</th><td class="l"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $i = 1;</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
  </ul>
</div>
      </div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c?format=diff&new=b898331d5e5550775358c4e1853c0bae324e302c" class="diff">Unified Diff</a>
        </li><li class="last">
          <a rel="nofollow" href="http://dev2.theyorker.co.uk/trac/changeset/b898331d5e5550775358c4e1853c0bae324e302c?format=zip&new=b898331d5e5550775358c4e1853c0bae324e302c" class="zip">Zip Archive</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">
        Powered by <a href="../about.html"><strong>Trac 0.11.1</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.
      </p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>